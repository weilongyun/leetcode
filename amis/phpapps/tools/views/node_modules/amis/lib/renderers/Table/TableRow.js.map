{
    "version": 3,
    "file": "TableRow.js",
    "sourceRoot": "",
    "sources": [
        "/src/renderers/Table/TableRow.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "import {observer} from 'mobx-react';\nimport React from 'react';\nimport {IRow, IColumn} from '../../store/table';\nimport {RendererProps} from '../../factory';\nimport {Action} from '../Action';\nimport {reaction} from 'mobx';\n\ninterface TableRowProps extends Pick<RendererProps, 'render'> {\n  onCheck: (item: IRow) => void;\n  classPrefix: string;\n  renderCell: (\n    region: string,\n    column: IColumn,\n    item: IRow,\n    props: any\n  ) => React.ReactNode;\n  columns: Array<IColumn>;\n  item: IRow;\n  parent?: IRow;\n  itemClassName?: string;\n  itemIndex: number;\n  regionPrefix?: string;\n  checkOnItemClick?: boolean;\n  [propName: string]: any;\n}\n\nexport class TableRow extends React.Component<TableRowProps> {\n  reaction?: () => void;\n  constructor(props: TableRowProps) {\n    super(props);\n    this.handleAction = this.handleAction.bind(this);\n    this.handleQuickChange = this.handleQuickChange.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n\n    const item = props.item;\n    const parent = props.parent;\n    const columns = props.columns;\n    this.reaction = reaction(\n      () =>\n        `${item.isHover}${item.checked}${JSON.stringify(item.data)}${\n          item.moved\n        }${item.modified}${item.expanded}${parent?.expanded}${columns.length}`,\n      () => this.forceUpdate(),\n      {\n        onError: () => this.reaction!()\n      }\n    );\n  }\n\n  shouldComponentUpdate(nextProps: TableRowProps) {\n    const props = this.props;\n    if (props.columns !== nextProps.columns) {\n      return true;\n    }\n\n    // 不需要更新，因为子节点已经 observer 了\n    return false;\n  }\n\n  componentWillUnmount() {\n    this.reaction?.();\n  }\n\n  handleClick(e: React.MouseEvent<HTMLTableRowElement>) {\n    const target: HTMLElement = e.target as HTMLElement;\n    const ns = this.props.classPrefix;\n    let formItem;\n\n    if (\n      !e.currentTarget.contains(target) ||\n      ~['INPUT', 'TEXTAREA'].indexOf(target.tagName) ||\n      ((formItem = target.closest(`button, a, [data-role=\"form-item\"]`)) &&\n        e.currentTarget.contains(formItem))\n    ) {\n      return;\n    }\n\n    this.props.onCheck(this.props.item);\n  }\n\n  handleAction(e: React.UIEvent<any>, action: Action, ctx: any) {\n    const {onAction, item} = this.props;\n    onAction && onAction(e, action, ctx || item.data);\n  }\n\n  handleQuickChange(\n    values: object,\n    saveImmediately?: boolean,\n    savePristine?: boolean,\n    resetOnFailed?: boolean\n  ) {\n    const {onQuickChange, item} = this.props;\n    onQuickChange &&\n      onQuickChange(item, values, saveImmediately, savePristine, resetOnFailed);\n  }\n\n  render() {\n    const {\n      itemClassName,\n      itemIndex,\n      item,\n      columns,\n      renderCell,\n      children,\n      footableMode,\n      footableColSpan,\n      regionPrefix,\n      checkOnItemClick,\n      classPrefix: ns,\n      render,\n      classnames: cx,\n      parent,\n      ...rest\n    } = this.props;\n\n    // console.log('TableRow');\n\n    if (footableMode) {\n      if (!item.expanded) {\n        return null;\n      }\n\n      return (\n        <tr\n          data-id={item.id}\n          data-index={item.newIndex}\n          onClick={checkOnItemClick ? this.handleClick : undefined}\n          className={cx(itemClassName, {\n            'is-hovered': item.isHover,\n            'is-checked': item.checked,\n            'is-modified': item.modified,\n            'is-moved': item.moved,\n            [`Table-tr--odd`]: itemIndex % 2 === 0,\n            [`Table-tr--even`]: itemIndex % 2 === 1\n          })}\n        >\n          <td className={cx(`Table-foot`)} colSpan={footableColSpan}>\n            <table className={cx(`Table-footTable`)}>\n              <tbody>\n                {columns.map(column => (\n                  <tr key={column.index}>\n                    {column.label !== false ? (\n                      <th>\n                        {render(\n                          `${regionPrefix}${itemIndex}/${column.index}/tpl`,\n                          column.label\n                        )}\n                      </th>\n                    ) : null}\n\n                    {renderCell(\n                      `${regionPrefix}${itemIndex}/${column.index}`,\n                      column,\n                      item,\n                      {\n                        ...rest,\n                        width: null,\n                        rowIndex: itemIndex,\n                        colIndex: column.rawIndex,\n                        key: column.index,\n                        onAction: this.handleAction,\n                        onQuickChange: this.handleQuickChange\n                      }\n                    )}\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </td>\n        </tr>\n      );\n    }\n\n    if (parent && !parent.expanded) {\n      return null;\n    }\n\n    return (\n      <tr\n        onClick={checkOnItemClick ? this.handleClick : undefined}\n        data-index={item.depth === 1 ? item.newIndex : undefined}\n        data-id={item.id}\n        className={cx(\n          itemClassName,\n          {\n            'is-hovered': item.isHover,\n            'is-checked': item.checked,\n            'is-modified': item.modified,\n            'is-moved': item.moved,\n            'is-expanded': item.expanded,\n            'is-expandable': item.expandable,\n            [`Table-tr--odd`]: itemIndex % 2 === 0,\n            [`Table-tr--even`]: itemIndex % 2 === 1\n          },\n          `Table-tr--${item.depth}th`\n        )}\n      >\n        {columns.map(column =>\n          renderCell(`${itemIndex}/${column.index}`, column, item, {\n            ...rest,\n            rowIndex: itemIndex,\n            colIndex: column.rawIndex,\n            key: column.index,\n            onAction: this.handleAction,\n            onQuickChange: this.handleQuickChange\n          })\n        )}\n      </tr>\n    );\n  }\n}\n"
    ]
}