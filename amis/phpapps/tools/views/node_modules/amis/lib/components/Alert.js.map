{
    "version": 3,
    "file": "Alert.js",
    "sourceRoot": "",
    "sources": [
        "/src/components/Alert.tsx"
    ],
    "names": [],
    "mappings": "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",
    "sourcesContent": [
        "/**\n * @file Alert\n * @author fex\n */\n\nimport React from 'react';\nimport {render} from 'react-dom';\nimport Modal from './Modal';\nimport Button from './Button';\nimport {ClassNamesFn, themeable, ThemeProps} from '../theme';\nimport {LocaleProps, localeable} from '../locale';\nimport Html from './Html';\nimport {PlainObject} from '../types';\nimport {render as renderSchema} from '../factory';\n\nexport interface AlertProps extends ThemeProps, LocaleProps {\n  container?: any;\n  confirmText?: string;\n  cancelText?: string;\n  title?: string;\n  confirmBtnLevel?: string;\n  alertBtnLevel?: string;\n}\n\nexport interface AlertState {\n  show: boolean;\n  title?: string;\n  content: string;\n  confirm: boolean;\n  prompt?: boolean;\n  controls?: any;\n  value?: any;\n  confirmText?: string;\n}\n\nexport class Alert extends React.Component<AlertProps, AlertState> {\n  static instance: any = null;\n  static getInstance() {\n    if (!Alert.instance) {\n      console.warn('Alert 组件应该没有被渲染，所以隐性的渲染到 body 了');\n      const container = document.body;\n      const div = document.createElement('div');\n      container.appendChild(div);\n      render(<FinnalAlert />, div);\n    }\n\n    return Alert.instance;\n  }\n\n  _resolve: (value: any) => void;\n  _modal: any;\n  _body: any;\n  state: AlertState = {\n    show: false,\n    title: '',\n    content: '',\n    confirm: false\n  };\n  constructor(props: AlertProps) {\n    super(props);\n\n    this.close = this.close.bind(this);\n    this.handleConfirm = this.handleConfirm.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.modalRef = this.modalRef.bind(this);\n    this.handleFormSubmit = this.handleFormSubmit.bind(this);\n    this.scopeRef = this.scopeRef.bind(this);\n  }\n\n  static defaultProps = {\n    confirmText: '确认',\n    cancelText: '取消',\n    title: '系统消息',\n    alertBtnLevel: 'primary',\n    confirmBtnLevel: 'danger'\n  };\n\n  componentWillMount() {\n    Alert.instance = this;\n  }\n\n  componentDidMount() {\n    this._body && (this._body.innerHTML = this.state.content);\n  }\n\n  componentDidUpdate(prevProps: AlertProps, prevState: AlertState) {\n    if (prevState.content !== this.state.content) {\n      this._body && (this._body.innerHTML = this.state.content);\n    }\n  }\n\n  componentWillUnmount() {\n    Alert.instance = null;\n  }\n\n  schemaSope: any;\n  scopeRef(schemaSope: any) {\n    this.schemaSope = schemaSope;\n  }\n\n  handleConfirm() {\n    const form = this.schemaSope?.getComponentByName('form');\n\n    if (form) {\n      form.doAction({type: 'submit'});\n    } else {\n      this.close(true);\n    }\n  }\n\n  handleCancel() {\n    this.close(false);\n  }\n\n  close(confirmed: boolean) {\n    const isConfirm = this.state.confirm || this.state.prompt;\n\n    this.setState(\n      {\n        show: false\n      },\n      isConfirm ? () => this._resolve(confirmed) /*this._reject()*/ : undefined\n    );\n  }\n\n  alert(content: string, title?: string) {\n    this.setState({\n      title,\n      content,\n      show: true,\n      confirm: false\n    });\n  }\n\n  confirm(content: string, title?: string, confirmText?: string) {\n    this.setState({\n      title,\n      content,\n      show: true,\n      confirm: true,\n      confirmText\n    });\n\n    return new Promise(resolve => {\n      this._resolve = resolve;\n    });\n  }\n\n  prompt(\n    controls: any,\n    defaultValue?: any,\n    title: string = '请输入',\n    confirmText: string = '确认'\n  ) {\n    if (typeof controls === 'string') {\n      // 兼容浏览器标准用法。\n      controls = [\n        {\n          name: 'text',\n          label: controls,\n          type: 'text'\n        }\n      ];\n\n      if (typeof defaultValue === 'string') {\n        defaultValue = {\n          text: defaultValue\n        };\n      }\n    } else if (!Array.isArray(controls)) {\n      controls = [controls];\n    }\n\n    this.setState({\n      title,\n      controls,\n      show: true,\n      prompt: true,\n      value: defaultValue,\n      confirmText\n    });\n\n    return new Promise(resolve => {\n      this._resolve = resolve;\n    });\n  }\n\n  modalRef(ref: any) {\n    this._modal = ref;\n  }\n\n  handleFormSubmit(values: any) {\n    this.close(values);\n  }\n\n  render() {\n    const {\n      container,\n      cancelText,\n      confirmText,\n      title,\n      confirmBtnLevel,\n      alertBtnLevel,\n      classnames: cx,\n      theme\n    } = this.props;\n    const __ = this.props.translate;\n    const finalTitle = __(this.state.title ?? title);\n    const finalConfirmText = __(this.state.confirmText ?? confirmText);\n\n    return (\n      <Modal\n        show={this.state.show}\n        onHide={this.handleCancel}\n        container={container}\n        ref={this.modalRef}\n        closeOnEsc\n      >\n        {finalTitle ? (\n          <div className={cx('Modal-header')}>\n            <div className={cx('Modal-title')}>{finalTitle}</div>\n          </div>\n        ) : null}\n        <div className={cx('Modal-body')}>\n          {this.state.prompt ? (\n            renderForm(\n              this.state.controls,\n              this.state.value,\n              this.handleFormSubmit,\n              this.scopeRef,\n              theme\n            )\n          ) : (\n            <Html html={this.state.content} />\n          )}\n        </div>\n        {finalConfirmText ? (\n          <div className={cx('Modal-footer')}>\n            {this.state.confirm || this.state.prompt ? (\n              <Button onClick={this.handleCancel}>{__(cancelText)}</Button>\n            ) : null}\n            <Button\n              level={\n                this.state.confirm || this.state.prompt\n                  ? confirmBtnLevel\n                  : alertBtnLevel\n              }\n              onClick={this.handleConfirm}\n            >\n              {finalConfirmText}\n            </Button>\n          </div>\n        ) : null}\n      </Modal>\n    );\n  }\n}\n\nfunction renderForm(\n  controls: Array<any>,\n  value: PlainObject = {},\n  callback?: (values: PlainObject) => void,\n  scopeRef?: (value: any) => void,\n  theme?: string\n) {\n  return renderSchema(\n    {\n      name: 'form',\n      type: 'form',\n      wrapWithPanel: false,\n      mode: 'horizontal',\n      controls,\n      messages: {\n        validateFailed: ''\n      }\n    },\n    {\n      data: value,\n      onFinished: callback,\n      scopeRef,\n      theme\n    },\n    {\n      session: 'prompt'\n    }\n  );\n}\n\nexport const alert: (content: string, title?: string) => void = (\n  content,\n  title\n) => Alert.getInstance().alert(content, title);\nexport const confirm: (\n  content: string,\n  title?: string,\n  confirmText?: string\n) => Promise<any> = (content, title, confirmText) =>\n  Alert.getInstance().confirm(content, title, confirmText);\nexport const prompt: (\n  controls: any,\n  defaultvalue?: any,\n  title?: string,\n  confirmText?: string\n) => Promise<any> = (controls, defaultvalue, title, confirmText) =>\n  Alert.getInstance().prompt(controls, defaultvalue, title, confirmText);\nexport const FinnalAlert = themeable(localeable(Alert));\nexport default FinnalAlert;\n"
    ]
}